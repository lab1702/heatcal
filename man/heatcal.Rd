% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/heatcal.R
\name{heatcal}
\alias{heatcal}
\title{Create a Calendar Heatmap}
\usage{
heatcal(
  dates,
  values,
  ncolors = 99,
  color = "r2g",
  date.form = "\%Y-\%m-\%d",
  week.start = c("Monday", "Sunday")
)
}
\arguments{
\item{dates}{A vector of dates. Can be character strings, factors, Date objects,
or POSIXt objects. Character/factor dates are parsed using \code{date.form}.}

\item{values}{A numeric vector of values corresponding to each date. Must be
the same length as \code{dates}.}

\item{ncolors}{Integer. The number of colors in the gradient palette. Higher
values give smoother color transitions. Default is 99.}

\item{color}{Character string specifying the color scheme (case-insensitive).
Options are:
\itemize{
\item \code{"r2g"}: Red to green (default) - good for showing negative to positive
\item \code{"g2r"}: Green to red - reversed, good for "lower is better" metrics
\item \code{"r2b"}: Blue to red - diverging, colorblind-friendlier
\item \code{"w2b"}: White to blue - sequential, good for counts/frequencies
}}

\item{date.form}{Character string specifying the date format for parsing
character/factor dates. Uses \code{\link[=strptime]{strptime()}} format codes.
Default is \code{"\%Y-\%m-\%d"} (e.g., "2024-01-15").}

\item{week.start}{Character string specifying which day starts the week.
Either "Monday" (default, ISO standard) or "Sunday" (US standard).}
}
\value{
Invisibly returns a data frame containing the processed calendar data
with columns:
\itemize{
\item \code{date.seq}: Date sequence covering all years in the input
\item \code{value}: The mapped values (NA for dates not in input)
\item \code{dotw}: Day of the week (0-6, where 0 is the first day per week.start)
\item \code{woty}: Week of the year (1-53)
\item \code{yr}: Year as a factor
\item \code{month}: Month number (1-12)
}
}
\description{
Displays time-series data as a calendar heatmap, where each day is represented
as a cell colored according to its value. Years are stacked vertically with
months labeled across the top and days of the week on the left side.
}
\details{
The function creates a multi-panel plot with one row per year and a color
legend at the bottom. Each cell represents one day, colored according to its
value using the specified color gradient. Days without data are left uncolored.

Month boundaries are drawn with thicker black lines to help distinguish
months visually. The color scale is linear, mapping the minimum value to
one end of the palette and the maximum to the other.

If duplicate dates are provided, a warning is issued and only the last value
for each date is used. If all values are identical, the color range is
expanded by +/-0.5 to ensure proper color mapping.

Graphics parameters are saved and restored on exit, so the function should
not affect subsequent plots.

Note that plotting may fail with an error if the graphics device is too small
to fit all years. Use \code{\link[=heatcal_aspect]{heatcal_aspect()}} to calculate appropriate device
dimensions that ensure each day cell is square and all years fit properly.
}
\examples{
# Basic usage with random data
set.seed(42)
dates <- seq(as.Date("2023-01-01"), as.Date("2024-06-30"), by = "day")
values <- cumsum(rnorm(length(dates)))
heatcal(dates, values)

# Using different color schemes
heatcal(dates, values, color = "w2b") # White to blue
heatcal(dates, values, color = "r2b") # Blue to red (diverging)

# Sunday-start weeks (US style)
heatcal(dates, values, week.start = "Sunday")

# Parsing dates from character strings
date_strings <- c("01/15/2024", "01/16/2024", "01/17/2024")
vals <- c(10, 20, 15)
heatcal(date_strings, vals, date.form = "\%m/\%d/\%Y")

}
\seealso{
\code{\link[=heatcal_aspect]{heatcal_aspect()}} for calculating device dimensions with square day cells,
\code{\link[=strptime]{strptime()}} for date format codes,
\code{\link[grDevices:colorRamp]{grDevices::colorRampPalette()}} for the color interpolation used internally
}
\author{
Paul Bleicher (original), Lars Bernhardsson (base R port)
}
